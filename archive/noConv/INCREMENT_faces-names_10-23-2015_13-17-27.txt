./incDriver.py data/faces-names.csv -C -I -k 20 -T -v 1


Using: data/faces-names.csv (624)  --  (0.898818 s)
Initial Clustering: kmeans
Initial:  --  (1.742554 s)
Accuracy: 383 of 624: 61.378 %
H: 0.721825 C: 0.737034 V: 0.729350 JCC: 0.345675

Rows are labels, Columns are Clusters

       0   1   2   3   4   5   6  7   8  9  10  11  12  13  14  15  16  17  18  19
   0   0   0   0   0   7   0   0  0   0  0   0   0   0   0   0   0   0   0   0  23
   1   0   0   0   0   0   0   0  7   1  0   1   0   0   0   7   0   0  15   0   0
   2   6   0   0   0   0   0  23  0   1  0   0   0   0   0   0   0   0   0   0   0
   3   0   0   0   8   0   0   0  0   0  0   0  16   0   0   0   0   3   5   0   0
   4   0   0   0   0   0   0   4  0   0  0   4   0   0  20   0   0   0   0   4   0
   5   0   0   0   0   4   0   0  8   0  0   0   0   0   0   4   0   0  14   0   0
   6   0   0   0  20  11   0   0  0   0  0   0   0   0   0   0   0   0   0   0   0
   7   0   0   0   0   0   0   0  0   0  4   0   0   0   0   0  28   0   0   0   0
   8   8   0   0   0   0   0   0  0   0  0   0   0   0   0   0   0   0   0  24   0
   9  20   0   1   0   0   0   0  0   0  0   0   0   0   3   0   0   0   0   7   0
  10   0   0  15   0   0   0   0  7   0  0   8   0   0   0   0   0   2   0   0   0
  11   0  31   0   0   0   0   0  0   0  0   0   0   0   0   0   0   0   0   0   1
  12  18   0   0   0   0   0   0  0   0  0   0   0   0   3   0   0   0   0  11   0
  13   0   0   0   0   0   0   0  0  31  0   0   0   0   0   0   0   0   0   0   0
  14   0   0   0   0   0  29   0  0   0  0   0   0   0   0   0   0   3   0   0   0
  15   0   0   0   0   0   8   0  0   0  0   8   0   0   0   0   0  13   3   0   0
  16   0   0  23   0   0   0   0  0   0  0   8   0   0   0   0   0   0   0   0   0
  17   0   0   0   0   0   0   0  1   0  0   7   0   0  13   0   0   7   0   0   0
  18   0   0   0   0   0   0   0  0   0  0   0   0  23   0   0   0   0   0   0   9
  19   0   0   0   2   0   0   0  0   0  0   0  21   0   0   8   0   0   0   0   0




Class: MergeINCREMENT
	RecursiveOPTICS
	MedoidSelector
	FarthestLabelFeedback
	OracleMatching
	Siamese


Siamese Setup:
	Batch Size: 10
	Output Size: 100
	Train Size: 100000

Testing INCREMENT
Subclustering:
Computing Distance
Running OPTICS: minPts = 5

Subcluster Breakdown:
	0: 2.325660 (52)
		0: 2.888363 -- 1.541147  (8)
		1: 1.288400 -- 0.542778  (8)
		2: 2.394058 -- 1.037577  (7)
		3: 2.563316 -- 1.169917  (17)
		4: 2.436807 -- 1.218403  (6)
		5: 2.094101 -- 1.081669  (6)
	--> std: 1.245130 -- 0.296714

	1: 3.221768 (31)
		6: 2.706030 -- 1.211321  (7)
		7: 3.372192 -- 1.083509  (24)
	--> std: 1.147955 -- 0.063906

	2: 2.070505 (39)
		8: 3.594670 -- 1.538874  (8)
		9: 2.765541 -- 1.365076  (7)
		10: 1.827060 -- 1.105059  (7)
		11: 0.946294 -- 0.546507  (4)
		12: 0.443800 -- 0.272355  (4)
		13: 0.826597 -- 0.477236  (4)
		14: 2.195472 -- 2.792053  (5)
	--> std: 1.798901 -- 0.800232

	3: 2.668942 (30)
		15: 1.929631 -- 1.132227  (4)
		16: 1.567976 -- 0.940349  (4)
		17: 2.737823 -- 1.588088  (4)
		18: 2.247759 -- 0.905311  (9)
		19: 3.877410 -- 1.786642  (9)
	--> std: 1.598457 -- 0.354612

	4: 2.096354 (22)
		20: 2.741013 -- 1.803456  (7)
		21: 1.118947 -- 0.666856  (4)
		22: 2.342612 -- 0.958536  (7)
		23: 1.514654 -- 0.875531  (4)
	--> std: 1.390751 -- 0.433179

	5: 1.839649 (37)
		24: 2.901326 -- 1.678502  (4)
		25: 1.946079 -- 1.123569  (4)
		26: 1.584221 -- 0.782995  (11)
		27: 1.101362 -- 0.668021  (4)
		28: 1.898599 -- 1.127376  (4)
		29: 2.126089 -- 1.934895  (5)
		30: 1.724131 -- 1.573519  (5)
	--> std: 1.365339 -- 0.437920

	6: 2.076935 (27)
		31: 0.302392 -- 0.176827  (4)
		32: 1.987930 -- 0.741469  (14)
		33: 3.004074 -- 1.240620  (9)
	--> std: 1.248961 -- 0.434566

	7: 2.954926 (23)
		34: 3.332844 -- 1.468059  (7)
		35: 2.450805 -- 1.018604  (7)
		36: 3.053083 -- 1.777697  (9)
	--> std: 1.527381 -- 0.311646

	8: 3.609682 (33)
		37: 3.762938 -- 1.343127  (14)
		38: 3.496757 -- 1.987422  (19)
	--> std: 1.748368 -- 0.322148

	9: 1.116805 (4)
		39: 1.116805 -- 0.644787  (4)
	--> std: 0.644787 -- 0.000000

	10: 2.117274 (36)
		40: 2.914006 -- 1.554269  (8)
		41: 1.409344 -- 0.840053  (4)
		42: 0.634450 -- 0.405274  (4)
		43: 1.801348 -- 1.123782  (4)
		44: 1.748315 -- 0.763310  (7)
		45: 2.810117 -- 2.454376  (9)
	--> std: 1.729659 -- 0.665338

	11: 1.937771 (37)
		46: 0.828345 -- 0.480226  (4)
		47: 1.150775 -- 0.749226  (8)
		48: 0.989631 -- 0.592330  (4)
		49: 2.165429 -- 0.909215  (7)
		50: 2.861529 -- 0.911259  (14)
	--> std: 1.162619 -- 0.171272

	12: 3.051507 (23)
		51: 3.051507 -- 0.967579  (23)
	--> std: 0.967579 -- 0.000000

	13: 1.410889 (39)
		52: 1.220196 -- 0.938561  (3)
		53: 0.455264 -- 0.263112  (4)
		54: 0.611392 -- 0.358008  (4)
		55: 1.005527 -- 0.584205  (4)
		56: 0.638911 -- 0.373084  (4)
		57: 2.419559 -- 1.385509  (16)
		58: 0.451693 -- 0.262273  (4)
	--> std: 1.297554 -- 0.390846

	14: 3.136646 (19)
		59: 2.412888 -- 1.403609  (4)
		60: 3.512701 -- 1.588902  (10)
		61: 2.963541 -- 1.482155  (5)
	--> std: 1.585623 -- 0.075937

	15: 2.162731 (28)
		62: 3.113767 -- 1.504945  (12)
		63: 2.131992 -- 1.231112  (4)
		64: 1.418808 -- 0.823092  (4)
		65: 1.348351 -- 0.829428  (4)
		66: 0.898662 -- 0.533816  (4)
	--> std: 1.487542 -- 0.342022

	16: 3.657703 (28)
		67: 3.207810 -- 1.416939  (16)
		68: 4.257560 -- 1.717688  (12)
	--> std: 1.637564 -- 0.150375

	17: 2.603641 (37)
		69: 2.768463 -- 1.877996  (8)
		70: 2.650872 -- 0.955124  (15)
		71: 2.052789 -- 1.220386  (4)
		72: 2.621278 -- 1.578061  (10)
	--> std: 1.416378 -- 0.350040

	18: 2.129378 (46)
		73: 3.342228 -- 1.526511  (6)
		74: 1.281065 -- 0.543857  (8)
		75: 1.329210 -- 0.537832  (8)
		76: 2.721529 -- 1.465110  (20)
		77: 0.646310 -- 0.373147  (4)
	--> std: 1.457109 -- 0.499373

	19: 2.630595 (33)
		78: 2.007442 -- 0.875303  (8)
		79: 2.830004 -- 1.652681  (25)
	--> std: 1.542467 -- 0.388689

	Avg: 2.440968 -- 0.663386 
	Std: 1.400006 -- 0.274130 

Subclusters Formed: 80

Selecting Representatives:
Representatives:
[4, 3, 4, 6, 2, 2, 2, 0, 5, 2, 1, 3, 2, 0, 0, 2, 2, 2, 0, 0, 1, 3, 4, 2, 1, 0, 1, 2, 2, 0, 0, 2, 7, 4, 2, 0, 6, 6, 6, 3, 4, 1, 1, 1, 0, 0, 2, 1, 1, 4, 0, 2, 0, 3, 0, 3, 3, 3, 3, 1, 1, 3, 7, 3, 2, 3, 2, 2, 4, 3, 2, 2, 1, 5, 1, 3, 1, 0, 2, 10]


Generating Feedback:
Farthest First
Computing pairwise distances between representatives.
Beginning Queries
Feedback: 2
	{'ch4f': [56]}
	{'megak': [59]}
Number of Queries: 2

Merging Subclusters:
Generating Data

Train All

Merged Feedback:
	[[59], [56]] 2

Connot Link Subcluster Constraints:
	[set([1]), set([0])] 2

Test All

Creating files for: _deploy
Train_data: (8, 1, 64, 64)
Data: (624, 1, 64, 64)
Creating files for: _train
Network:
layer {
  name: "data"
  type: "HDF5Data"
  top: "data"
  top: "labels"
  hdf5_data_param {
    source: "_train.txt"
    batch_size: 10
    shuffle: true
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  param {
    name: "conv1_w"
    lr_mult: 1
  }
  param {
    name: "conv1_b"
    lr_mult: 2
  }
  convolution_param {
    num_output: 20
    kernel_size: 5
    weight_filler {
      type: "xavier"
    }
  }
}
layer {
  name: "r1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 2
    stride: 2
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "pool1"
  top: "conv2"
  param {
    name: "conv2_w"
    lr_mult: 1
  }
  param {
    name: "conv2_b"
    lr_mult: 2
  }
  convolution_param {
    num_output: 50
    kernel_size: 5
    weight_filler {
      type: "xavier"
    }
  }
}
layer {
  name: "r2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 2
    stride: 2
  }
}
layer {
  name: "ip1"
  type: "InnerProduct"
  bottom: "pool2"
  top: "ip1"
  param {
    name: "ip1_w"
    lr_mult: 1
  }
  param {
    name: "ip1_b"
    lr_mult: 2
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "gaussian"
      std: 0.1
    }
  }
}
layer {
  name: "r3"
  type: "ReLU"
  bottom: "ip1"
  top: "ip1"
}
layer {
  name: "feat"
  type: "InnerProduct"
  bottom: "ip1"
  top: "feat"
  param {
    name: "feat_w"
    lr_mult: 1
  }
  param {
    name: "feat_b"
    lr_mult: 2
  }
  inner_product_param {
    num_output: 100
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
    }
  }
}
layer {
  name: "loss"
  type: "WrapperContrastiveLoss"
  bottom: "feat"
  bottom: "labels"
  top: "loss"
  contrastive_loss_param {
    margin: 1
  }
}


Training siamese network
data (624, 1, 64, 64)
targets: (624,)
K: 2
Reclustering

~! 2 !~
Accuracy: 64 of 624: 10.256 %
H: 0.175477 C: 0.764822 V: 0.285459 JCC: 0.084659



~! 12 !~
Accuracy: 286 of 624: 45.833 %
H: 0.595941 C: 0.820402 V: 0.690386 JCC: 0.280777



~! 22 !~
Accuracy: 397 of 624: 63.622 %
H: 0.736696 C: 0.874201 V: 0.799580 JCC: 0.399864



~! 32 !~
Accuracy: 497 of 624: 79.647 %
H: 0.861984 C: 0.911088 V: 0.885856 JCC: 0.593755



~! 42 !~
Accuracy: 563 of 624: 90.224 %
H: 0.923545 C: 0.947644 V: 0.935439 JCC: 0.757506



~! 52 !~
Accuracy: 578 of 624: 92.628 %
H: 0.924692 C: 0.927739 V: 0.926213 JCC: 0.760018



~! 62 !~
Accuracy: 564 of 624: 90.385 %
H: 0.906967 C: 0.912837 V: 0.909893 JCC: 0.717518



~! 72 !~
Accuracy: 580 of 624: 92.949 %
H: 0.925324 C: 0.929300 V: 0.927308 JCC: 0.771391


INCREMENT: (72)
SubClusters: 80
Accuracy: 564 of 624: 90.385 %
H: 0.932929 C: 0.663843 V: 0.775713 JCC: 0.249006


Final
Accuracy: 580 of 624: 92.949 %
H: 0.925324 C: 0.929300 V: 0.927308 JCC: 0.771391

Rows are labels, Columns are Clusters

       0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19
   0   0   0   0   0  30   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
   1   0   1   0   0   0   0   0  29   1   0   0   0   0   0   0   0   0   0   0   0
   2   0   0   0   0   1   0   0   0   0   0   0   0   0   0   0  31   0   0   0   0
   3   0   0   0   0   0   0   0   0   0   0  29   0   0   0   0   0   0   0   3   0
   4   0  32   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
   5   0   0  30   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
   6   0   0   0   0   0   0  31   0   0   0   0   0   0   0   0   0   0   0   0   0
   7   0   0   0   0   0   0   0   0   0  32   0   0   0   0   0   0   0   0   0   0
   8   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0  32   0   0
   9   1   0   0   0   0   8   0   0   0   0   0   0   3   0   0   0   0   0   0  19
  10   0   0   0  30   0   0   0   0   0   0   0   0   2   0   0   0   0   0   0   0
  11   0   0   0   0   0   0   0   0   1   0   0   0   0  29   0   0   0   0   0   0
  12   0   0   0   0   0  32   0   0   0   0   0   0   0   0   0   0   0   0   0   0
  13   0   0   0   0   0   0   0   0  31   0   0   0   0   0   0   0   0   0   0   0
  14   0   0   0   0   0   0   0   0   0   0   0  30   2   0   0   0   0   0   0   0
  15   0   4   0   0   0   0   0   0   0   0   1   0   4   0   0   0   0   0  23   0
  16  31   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
  17   0   0   1   0   0   0   0   0   0   0   0   0  27   0   0   0   0   0   0   0
  18   0   0   0   0   9   0   0   0   0   0   0   0   0   0   0   0  23   0   0   0
  19   0   0   0   0   0   0   2   0   0   0   0   0   0   0  29   0   0   0   0   0



Total Time: 2 h 56 m 23.912980 s




Solver:
net: "_TRAIN_NET.prototxt"
base_lr: 0.01
lr_policy: "inv"
gamma: 0.0001
power: 0.75
momentum: 0.9
max_iter: 10000
display: 1000
weight_decay: 0.000000
solver_mode: GPU
